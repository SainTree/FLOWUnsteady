<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced System Definition · FLOWUnsteady</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FLOWUnsteady logo"/></a><div class="docs-package-name"><span class="docs-autofit">FLOWUnsteady</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/FLOWVLM/">FLOWVLM</a></li><li><a class="tocitem" href="../../reference/VPM/">Vortex Particle Method</a></li><li><a class="tocitem" href="../../reference/FLOWUnsteady/">FLOWUnsteady</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../first-steps/">First Steps</a></li><li><a class="tocitem" href="../define-complex-wings/">Advanced Wing Definition</a></li><li class="is-active"><a class="tocitem" href>Advanced System Definition</a><ul class="internal"><li><a class="tocitem" href="#Wing-Subsystems-1"><span>Wing Subsystems</span></a></li><li><a class="tocitem" href="#VLM-Systems-1"><span>VLM Systems</span></a></li><li><a class="tocitem" href="#Wake-Systems-1"><span>Wake Systems</span></a></li><li><a class="tocitem" href="#Rotor-Systems-1"><span>Rotor Systems</span></a></li><li><a class="tocitem" href="#Tilting-Systems-1"><span>Tilting Systems</span></a></li></ul></li><li><a class="tocitem" href="../define-a-rotor/">Advanced Rotor Definition</a></li><li><a class="tocitem" href="../define-kinematic-maneuvers/">Advanced Kinematic Maneuver Definition</a></li><li><a class="tocitem" href="../set-up-runtime-functions/">Seting up Run-time Functions</a></li></ul></li><li><span class="tocitem">How-to-Guide</span><ul><li><a class="tocitem" href="../../how-to-guide/paraview-visualization/">Visualize with Paraview</a></li><li><a class="tocitem" href="../../how-to-guide/select-a-solver/">Select a Solver</a></li><li><a class="tocitem" href="../../how-to-guide/calculate-aerodynamic-forces/">Calculate Aerodynamic Forces</a></li><li><a class="tocitem" href="../../how-to-guide/wake-stability/">Approach Wake Stability Issues</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Advanced System Definition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced System Definition</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/FLOWUnsteady/blob/master/docs/src/tutorials/define-complex-systems.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-System-Definition-1"><a class="docs-heading-anchor" href="#Advanced-System-Definition-1">Advanced System Definition</a><a class="docs-heading-anchor-permalink" href="#Advanced-System-Definition-1" title="Permalink"></a></h1><p>In this guide, we will cover how to define complex systems. Basic system definitions were presented in the <a href="../first-steps/#First-Steps-1">First Steps</a> tutorial, but applications quickly become more complex than a simple, control-free wing.</p><h2 id="Wing-Subsystems-1"><a class="docs-heading-anchor" href="#Wing-Subsystems-1">Wing Subsystems</a><a class="docs-heading-anchor-permalink" href="#Wing-Subsystems-1" title="Permalink"></a></h2><p>We will first cover creating wing subsystems.  The key here is that any system can be a sub-system. Take, for example, the vertical stabilizer and rudder from <a href="../define-complex-wings/#Advanced-Wing-Definition-1">Advanced Wing Definition</a> which we can define a add to a wing system.</p><pre><code class="language-none">#Vertical Stabilizer
span = 0.25                                     #length of full span
numlattice = 5                                  #number of lattice elements on half-span
poschord = [0.0; 1.0]                #postion of chord stations
lengthtipchordvstab = 0.05                          #length of tip chord
lengthchordvstab = [1.25; 1.0]     #length of chords
twistchord = [0.0; 0.0]                         #twist of chords, in degrees
sweepsection = [0.0]                      #sweep of sections between chords, in degrees
dihedralsection = [0.0]                    #dihedral of sections between chords, in degrees
aspectratio = span/lengthtipchordvstab

verticalstabilizer = vlm.complexWing(span, aspectratio, numlattice, poschord, lengthchordvstab, twistchord, sweepsection, dihedralsection; symmetric=false, chordalign=1.0)

originvstab = [0.5; 0.0; 0.0]                       #origin moved 0.5 in positive x-direction
csysvstab = [1.0 0.0 0.0; 0.0 0.0 1.0; 0.0 1.0 0.0] #csys rotated 90 degrees from default
vlm.setcoordsystem(verticalstabilizer,originvstab,csysvstab)


#Rudder
span = 0.25                                     #length of full span
numlattice = 5                                  #number of lattice elements on half-span
poschord = [0.0; 0.25; 1.0]                #postion of chord stations
lengthtipchord = 0.03                          #length of tip chord
lengthchord = [1.25; 1.5; 1.0]     #length of chords
twistchord = [0.0; 0.0; 0.0]                         #twist of chords, in degrees
sweepsection = [0.0; 0.0]                      #sweep of sections between chords, in degrees
dihedralsection = [0.0; 0.0]                    #dihedral of sections between chords, in degrees
aspectratio = span/lengthtipchord

rudder = vlm.complexWing(span, aspectratio, numlattice, poschord, lengthchord, twistchord, sweepsection, dihedralsection; symmetric=false, chordalign=0.0)

lengthrootchordvstab = lengthchordvstab[1]*lengthtipchordvstab
originrudder = [0.5+lengthrootchordvstab; 0.0; 0.0]                       #account for vstab position and chord
csysrudder = [1.0 0.0 0.0; 0.0 0.0 1.0; 0.0 1.0 0.0] #csys rotated 90 degrees from default
vlm.setcoordsystem(rudder,originrudder,csysrudder)


#System Definition
tail = vlm.WingSystem()
vlm.addwing(tail,&quot;vstab&quot;,verticalstabilizer)
vlm.addwing(tail,&quot;rudder&quot;,rudder)</code></pre><p>Now we might want that tail system to be part of a full system, so let&#39;s define the main wing and add both it and the tail system to the full system.</p><pre><code class="language-none">#Main Wing
span = 1.0                      #length of full span
numlattice = 10                 #number of lattice elements on half-span

poschord = [0.0; 0.5; 1.0]./span                #postion of chord stations
lengthtipchord = 0.03                            #length of tip chord
lengthchord = [0.075; 0.05; 0.03]./lengthtipchord   #length of chords
twistchord = [0.0; 0.0; -3.0]                   #twist of chords, in degrees
sweepsection = [10.0; 5.0]      #sweep of sections between chords, in degrees
dihedralsection = [0.0; 7.0]    #dihedral of sections between chords, in degrees
aspectratio = span/lengthtipchord

mainwing = vlm.complexWing(span, aspectratio, numlattice, poschord, lengthchord, twistchord, sweepsection, dihedralsection; symmetric=true)


#System Definition
system = vlm.WingSystem()
vlm.addwing(system,&quot;mainwing&quot;,mainwing)
vlm.addwing(system,&quot;tail&quot;,tail)</code></pre><p>And that&#39;s all there is to it. The main wing and tail system are now both components of the overall system. Any combination of wing objects and wing systems can be added to any system.</p><h2 id="VLM-Systems-1"><a class="docs-heading-anchor" href="#VLM-Systems-1">VLM Systems</a><a class="docs-heading-anchor-permalink" href="#VLM-Systems-1" title="Permalink"></a></h2><p>Anything that will be solved using the VLM (see Reference) needs to be identified as such. In our case, all the wings fall under this category.</p><pre><code class="language-none">vlm_system = vlm.WingSystem()
vlm.addwing(vlm_system,&quot;mainwing&quot;,mainwing)
vlm.addwing(vlm_system,&quot;tail&quot;,tail)</code></pre><h2 id="Wake-Systems-1"><a class="docs-heading-anchor" href="#Wake-Systems-1">Wake Systems</a><a class="docs-heading-anchor-permalink" href="#Wake-Systems-1" title="Permalink"></a></h2><p>You need to tell the solver which of the systems you&#39;ve created need to be included in the wake simulation.  In this case, we want everything to be in our wake system, which is defined just like before.</p><pre><code class="language-none">wake_system = vlm.WingSystem()
vlm.addwing(wake_system,&quot;mainwing&quot;,mainwing)
vlm.addwing(wake_system,&quot;tail&quot;,tail)</code></pre><h2 id="Rotor-Systems-1"><a class="docs-heading-anchor" href="#Rotor-Systems-1">Rotor Systems</a><a class="docs-heading-anchor-permalink" href="#Rotor-Systems-1" title="Permalink"></a></h2><p>Rotor systems begin with rotors, the definition of which is covered in <a href="../define-a-rotor/#Advanced-Rotor-Definition-1">Advanced Rotor Definition</a>.  Once you have rotors defined with their respetive databases, you can create rotor systems.  Let&#39;s add two rotors to our airplane in this guide to see how it is done.</p><p>First let&#39;s decide where we want to place the rotors.</p><pre><code class="language-none">posrotorplus = [0.0; 0.25; 0.0]      #xyz position of rotor in positive y-direction
posrotorminus = -posrotorplus       #xyz position of rotor in negative y-direction
vehicleaxis = [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]   #default coordinate system</code></pre><p>We need a few more parameters for defining rotors as well.</p><pre><code class="language-none">rotor_file = &quot;apc10x7.csv&quot;          # data file for rotor
data_path = uns.def_data_path       # data path to find file

R, B = uns.read_rotor(rotor_file; data_path=data_path)[[1,3]] #grab rotor radius
n = 100.0                           #target RPS
Vref = 20.0                         #freestream velocity
vind = sqrt( Vref^2 + (n*R)^2 )     #velocity at blade tip
rho = 1.225                         #(kg/m^3) air density
mu = 1.81e-5                        #(kg/ms) air dynamic viscosity
ReD = rho*2.0*R*vind/mu             #Diameter-based Reynolds

numbladeelements = 10               #number of blade elements
rotorpitch = 0.0                    #rotor pitch</code></pre><p>Now we are ready to define some propellers.</p><pre><code class="language-none">rotors = vlm.Rotor[]

push!(rotors,
        uns.generate_rotor(rotor_file;
                            pitch=rotorpitch,
                            n=numbladeelements,
                            CW=true,
                            ReD=ReD,
                            verbose=true,
                            xfoil=false,
                            data_path=data_path)
    )


push!(rotors,
        vlm.Rotor(!rotors[1].CW,
                    rotors[1].r,
                    rotors[1].chord,
                    rotors[1].theta,
                    rotors[1].LE_x,
                    rotors[1].LE_z,
                    rotors[1].B,
                    rotors[1].airfoils))

vlm.initialize(rotors[2], rotors[1].m)

vlm.setcoordsystem(rotors[1], posrotorminus, vehicleaxis; user=true)
vlm.setcoordsystem(rotors[2], posrotorplus, vehicleaxis; user=true)</code></pre><p>Now that we have defined our rotors, we can add them to the other systems</p><pre><code class="language-none">for (i, rotor) in enumerate(rotors)
    vlm.addwing(system, &quot;rotor$i&quot;, rotor)
    vlm.addwing(wake_system, &quot;Rotor$i&quot;, rotor)
end</code></pre><div class="admonition is-info"><header class="admonition-header">Repeated Object Names</header><div class="admonition-body"><p>You can only use a specific name in one system. Note how in the example above, <code>rotor$i</code> is used for the main system, and captial <code>Rotor$i</code> is used for the wake system</p></div></div><p>Finally, we need to create our rotor system, which is actually just a tuple of the rotor object we&#39;ve already created.</p><pre><code class="language-none">rotor_systems = (rotors, )</code></pre><p><img src="../../assets/howtofigs/complex-systems.gif" alt/></p><h2 id="Tilting-Systems-1"><a class="docs-heading-anchor" href="#Tilting-Systems-1">Tilting Systems</a><a class="docs-heading-anchor-permalink" href="#Tilting-Systems-1" title="Permalink"></a></h2><p>A tilting system is simply a tuple of all the wing systems that will be rotating according to specific definitions beyond the overall aircraft orientations. In our case, that would just be the rudder.</p><pre><code class="language-none">tilting_systems = (rudder, )</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../define-complex-wings/">« Advanced Wing Definition</a><a class="docs-footer-nextpage" href="../define-a-rotor/">Advanced Rotor Definition »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 11 June 2020 10:05">Thursday 11 June 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
